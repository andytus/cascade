{% extends 'base.html' %}


{% block page_scripts %}
    <script src="{{ STATIC_URL }}js/cartmanager/cart_search.js" xmlns="http://www.w3.org/1999/html"></script>

    <script type="text/javascript">

        //adding the search parameters and urls incoming from the request,
        // not in "love with this approach" but it works for now. And hey at least I didn't
        // hard code the urls.
        var search_parameters = {{ search_parameters|safe}};
        var customer_url = "{% url customer_app_profile%}";
        var cart_url = "{% url cart_app_profile %}";
        var location_url = "{% url location_app_profile %}";


    </script>

{% endblock %}


{% block title %} Cart Search {% endblock %}

{% block left %}
    <div>
   <b> {{ search_parameters }}</b>

    </div>
{% endblock %}


{% block main_content %}

    <!--knockout: view for carts-->
    <div class="results">
      Search for cart <span data-bind="text:search_for_type().replace('_', ' ')"></span>
       <i><span data-bind="text:search_for_value"></span></i>
      returned <b data-bind="text: count() || 'No'"></b> result<span data-bind="visible:count() == 0 || count() > 1">s</span>:

    <p> <b data-bind="text:page"></b></p>
    </div>

    <div data-bind="foreach: carts, visible: carts().length > 0">
        <div class="cart_info">
            <p data-bind="text: cart_size() + ' ' + cart_type()"></p>
            Serial Number: <a data-bind="attr: {href: cart_url, title: cart_serial}, text: cart_serial"></a>
            <p data-bind="text:'Address: '+ address()"></p>
        </div>
   </div>

    <!--display page list is count is above #TODO -->

    <div  data-bind="visible:count() > 1 " class="pagination pagination-large pagination-centered">
        <!-- looping through the page count -->
        <ul>
         <!-- seting to the previous page using count (see note below for more info)-->
         <li data-bind="visible:page() > 1"><a class="page_previous" data-bind="click: function(){getData(search_parameters, page()-1)}"><<</a></li>
        <!--ko foreach: ko.utils.range(1, count())-->
            <!--create the page links here, note the click calls the getData passing parameters from the server
                (i.e. top of the cart_search.html) and the current count (i.e. the page). Should look to
                 remove the click function() and just create a init and update on the getData function
                this would be cleaner... next time.
              -->
            <li class="page" data-bind="attr:{id: $data}"><a data-bind="text: $data, click:function(){$root.getData(search_parameters, $data) }"> </a></li>
          <!-- /ko -->
         <li data-bind="visible:count() > page()"><a class="page_next" data-bind="click: function(){getData(search_parameters, page()+1)}">>></a></li>
        </ul>
    </div>

{% endblock %}

{% block right %}
{% endblock %}